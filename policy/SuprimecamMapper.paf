#<?cfg paf policy ?>

#root: "/path/to/data"
#calibRoot: "/path/to/calibration"
#registryPath: "/path/to/registry/"
needCalibRegistry: true
#calibRegistryPath: "/path/to/calibration/registry/"

camera:     "../suprimecam/Full_Suprimecam_geom.paf"
defects:    "../suprimecam/defects"
defaultLevel: "Ccd"

exposures: {
    raw: {
        template:    "%(field)s/%(dateObs)s/%(pointing)05d/%(filter)s/SUPA%(visit)07d%(ccd)1d.fits"
        python:     "lsst.afw.image.DecoratedImageU"
        persistable:         "DecoratedImageU"
        storage:     "FitsStorage"
        level:        "Ccd"
        tables:        "raw"
        tables:        "raw_visit"
    }
    postISRCCD: {
        template:    "%(outRoot)s/postISRCCD/v%(visit)d-f%(filter)s/c%(ccd)02d.fits"
        python:        "lsst.afw.image.ExposureF"
        persistable:        "ExposureF"
        storage:    "FitsStorage"
        level:        "Ccd"
        tables:        "raw"
        tables:        "raw_visit"
    }
    visitim: {
        template:      "%(outRoot)s/visitim/v%(visit)d-f%(filter)s/c%(ccd)02d.fits"
        python:        "lsst.afw.image.ExposureF"
        persistable:        "ExposureF"
        storage:    "FitsStorage"
        level:        "Ccd"
        tables:        "raw"
        tables:        "raw_visit"
    }
    calexp: {
        template:      "%(outRoot)s/%(pointing)05d/%(filter)s/corr/CORR%(visit)07d%(ccd)d.fits"
        python:        "lsst.afw.image.ExposureF"
        persistable:        "ExposureF"
        storage:    "FitsStorage"
        level:        "Ccd"
        tables:        "raw"
        tables:        "raw_visit"
    }

    wcs: {
        template: "%(outRoot)s/%(pointing)05d/%(filter)s/corr/wcs%(visit)07d%(ccd)d.fits"
        python:        "lsst.afw.image.ExposureI"
        persistable:        "ExposureI"
        storage:    "FitsStorage"
        level:        "Ccd"
        tables:        "raw"
        tables:        "raw_visit"
        tables:        "raw_skyTile"
    }

    fcr: {
        template: "%(outRoot)s/%(pointing)05d/%(filter)s/corr/fcr%(visit)07d%(ccd)d.fits"
        python:        "lsst.afw.image.ExposureI"
        persistable:        "ExposureI"
        storage:    "FitsStorage"
        level:        "Ccd"
        tables:        "raw"
        tables:        "raw_visit"
        tables:        "raw_skyTile"
    }
    detj: {
        template:      "%(outRoot)s/%(pointing)05d/%(filter)s/corr/DETJ%(visit)07d%(ccd)d.fits"
        python:        "lsst.afw.image.ExposureF"
        persistable:        "ExposureF"
        storage:    "FitsStorage"
        level:        "Ccd"
        tables:        "raw"
        tables:        "raw_visit"
    }
    dcor: {
        template:      "%(outRoot)s/%(pointing)05d/%(filter)s/corr/DCOR%(visit)07d%(ccd)d.fits"
        python:        "lsst.afw.image.ExposureF"
        persistable:        "ExposureF"
        storage:    "FitsStorage"
        level:        "Ccd"
        tables:        "raw"
        tables:        "raw_visit"
    }

    warp: {
        template:      "%(outRoot)s/warp/v%(visit)d-f%(filter)s/s%(patch)d.fits"
        python:        "lsst.afw.image.ExposureF"
        persistable:        "ExposureF"
        storage:    "FitsStorage"
        level:        "Skytile"
        tables:        "raw"
        tables:        "raw_visit"
        columns:       "visit"
        columns:       "filter"
    }

    stack: {
        template:      "%(outRoot)s/stack/%(stack)05d/STK%(patch)08d%(filter)s.fits"
        python:        "lsst.afw.image.ExposureF"
        persistable:        "ExposureF"
        storage:    "FitsStorage"
        level:        "Skytile"
        tables:        "raw_skytile"
    }

    diff: {
        template:      "%(outRoot)s/diff/%(diff)05d/DIFF%(patch)08d.fits"
        python:        "lsst.afw.image.ExposureF"
        persistable:        "ExposureF"
        storage:    "FitsStorage"
        level:        "Skytile"
        tables:        "raw_skytile"
    }

    chisquared: {
        template:      "%(outRoot)s/stack/%(stack)05d/CHI%(patch)08d.fits"
        python:        "lsst.afw.image.ExposureF"
        persistable:        "ExposureF"
        storage:    "FitsStorage"
        level:        "Skytile"
        tables:        "raw_skytile"
    }
}

calibrations: {
    bias: {
        template:    "BIAS/%(calibDate)s/%(filter)s/%(mystery)s/BIAS-%(num)07d%(ccd)1d.fits"
        python:        "lsst.afw.image.ExposureF"
        persistable:        "ExposureF"
        storage:    "FitsStorage"
        level:        "Ccd"
        tables:     "bias"
        columns: "ccd"
        reference:   "raw_visit"
        refCols:     "visit"
        refCols:     "filter"
    }
    dark: {
        template:    "DARK/%(calibDate)s/%(filter)s/%(mystery)s/DARK-%(num)07d%(ccd)1d.fits"
        python:        "lsst.afw.image.ExposureF"
        persistable:        "ExposureF"
        storage:    "FitsStorage"
        level:        "Ccd"
        tables:     "dark"
        columns: "ccd"
        reference:   "raw_visit"
        refCols:     "visit"
        refCols:     "filter"
    }
    bgflat: {
        template:    "BGFLAT/%(calibDate)s/%(filter)s/%(mystery)s/BGFLAT-%(num)07d%(ccd)1d.fits"
        python:        "lsst.afw.image.ExposureF"
        persistable:        "ExposureF"
        storage:    "FitsStorage"
        level:        "Ccd"
        tables:     "bgflat"
        columns: "ccd"
        columns: "filter"
        columns: "taiObs"
        reference:   "raw_visit"
        refCols:     "visit"
        refCols:     "filter"
        filter:      true
        validRange:  true
        validStartName: validStart
        validEndName: validEnd
    }
    flat: {
        template:    "FLAT/%(calibDate)s/%(filter)s/%(mystery)s/FLAT-%(num)07d%(ccd)1d.fits"
        python:        "lsst.afw.image.ExposureF"
        persistable:        "ExposureF"
        storage:    "FitsStorage"
        level:        "Ccd"
        tables:     "flat"
        columns: "ccd"
        columns: "filter"
        columns: "taiObs"
        reference:   "raw_visit"
        refCols:     "visit"
        refCols:     "filter"
        filter:      true
        validRange:  true
        validStartName: validStart
        validEndName: validEnd
    }
    fringe: {
        template:    "FRINGE/%(calibDate)s/%(filter)s/%(mystery)s/FRINGE-%(num)07d%(ccd)1d.fits"
        python:        "lsst.afw.image.ExposureF"
        persistable:        "ExposureF"
        storage:    "FitsStorage"
        level:        "Ccd"
        tables:     "fringe"
        columns: "ccd"
        columns: "filter"
        columns: "taiObs"
        reference:   "raw_visit"
        refCols:     "visit"
        refCols:     "filter"
        filter:      true
        validRange:  true
        validStartName: validStart
        validEndName: validEnd
    }
}



datasets: {
    psf: {
        template:      "%(outRoot)s/%(pointing)05d/%(filter)s/output/PSF%(visit)07d%(ccd)1d.boost"
        python:        "lsst.afw.detection.Psf"
        persistable:        "Psf"
        storage:    "BoostStorage"
        tables:        "raw"
        tables:        "raw_visit"
    }
    apCorr: {
        template:      "%(outRoot)s/%(pointing)05d/%(filter)s/output/APC%(visit)07d%(ccd)1d.pickle"
        python:        "lsst.meas.algorithms.ApertureCorrection"
        persistable:        "ApertureCorrection"
        storage:    "PickleStorage"
        tables:        raw
        tables:        raw_visit
    }
    src: {
        template:      "%(outRoot)s/%(pointing)05d/%(filter)s/output/SRC%(visit)07d%(ccd)1d.fits"
        python:        "lsst.afw.table.SourceCatalog"
        persistable:        "SourceCatalog"
        storage:    "FitsCatalogStorage"
        tables:        "raw"
        tables:        "raw_visit"
    }
    icMatch: {
        template:      "%(outRoot)s/%(pointing)05d/%(filter)s/output/MATCH%(visit)07d%(ccd)1d.fits"
        python:        "lsst.afw.table.BaseCatalog"
        persistable:        "BaseCatalog"
        storage:    "FitsCatalogStorage"
        tables:        "raw"
        tables:        "raw_visit"
    }
    icSrc: {
        template:      "%(outRoot)s/%(pointing)05d/%(filter)s/output/ICSRC%(visit)07d%(ccd)1d.fits"
        python:        "lsst.afw.table.SourceCatalog"
        persistable:   "SourceCatalog"
        storage:       "FitsCatalogStorage"
        tables:        "raw"
        tables:        "raw_visit"
    }
    log: {
        template:      "%(outRoot)s/%(pointing)05d/%(filter)s/logs/run.log"
        python:        "str"
        persistable:   "None"
        storage:       "TextStorage"
    }
    logDir: {
        template:      "%(outRoot)s/%(pointing)05d/%(filter)s/logs"
        python:        "str"
        persistable:   "None"
        storage:       "None"
    }

    stacksources: {
        template:      "%(outRoot)s/stack/%(stack)05d/SRC%(patch)08d%(filter)s.fits"
        python:        "lsst.afw.table.SourceCatalog"
        persistable:   "SourceCatalog"
        storage:       "FitsCatalogStorage"
        tables:        "raw_skytile"
    }

    stackpsf: {
        template:      "%(outRoot)s/stack/%(stack)05d/PSF%(patch)08d%(filter)s.boost"
        python:        "lsst.afw.detection.Psf"
        persistable:   "Psf"
        storage:       "BoostStorage"
        tables:        "raw_skytile"
    }

    stackrgb: {
        # Will be read/written directly by the user; here for _filename only
        template:      "%(outRoot)s/stack/%(stack)05d/SRC%(patch)08d.tiff"
        python:        "lsst.afw.extensions.rgb.RgbImageF"
        persistable:   "RgbImageF"
        storage:       "SelfStorage"
        tables:        "None"
    }

    diffsources: {
        template:      "%(outRoot)s/diff/%(diff)05d/SRC%(patch)08d%(filter)s.fits"
        python:        "lsst.afw.table.SourceCatalog"
        persistable:   "SourceCatalog"
        storage:       "FitsCatalogStorage"
        tables:        "raw_skytile"
    }

    diffpsf: {
        template:      "%(outRoot)s/diff/%(diff)05d/PSF%(patch)08d%(filter)s.boost"
        python:        "lsst.afw.detection.Psf"
        persistable:   "Psf"
        storage:       "BoostStorage"
        tables:        "raw_skytile"
    }
}
